---
layout:     post
title:      "常微分方程的数值解法"
subtitle:   ""
date:       2019-02-08 22:00:00
author:     "陈实"
header-img: ""
catalog: true
tags:
    - 基础知识
---

半经典方法以及全经典方法主要就是解牛顿方程。常微分方程常用的数值解法包括欧拉法，改进的欧拉法以及龙格库塔法。其中欧拉法精度较低，我们主要采用的是龙格库塔法。

# 欧拉法
## 欧拉公式
记两个节点之间的步长$$h=x_{k+1}-x_k$$，数值方法作离散化，有欧拉公式（这个公式可按照左矩形法求积分作比较形象的理解）

$$y_{n+1}=y_n+f(x_n,y_n)h\ \ (n=0,1,2,\cdots)$$

其中$$f(x,y)=\frac{dy}{dx}$$。已知初值$$y_0$$，可依次得到$$y_1,y_2,\cdots$$。由泰勒公式，$$y(x_{n+1})=y(x_n)+hy'(x_n)+\frac{h^2}{2}y^{"}(\xi)$$，所以$$y(x_{n+1})-y_{n+1}=\frac{h^2}{2}y^{"}(\xi)$$，可见欧拉法精度仅有一阶。

## 隐式欧拉公式
使用向后差商可得隐式欧拉公式

$$y_{n+1}=y_n+f(x_{n+1},y_{n+1})h$$

隐式欧拉公式左右两边都有未知的$$y_{n+1}$$，往往需要求解非线性方程才能得到$$y_{n+1}$$，计算远比显式困难，但计算稳定性好。

## 欧拉中点公式
使用中心差商可得欧拉中点公式

$$y_{n+1}=y_{n-1}+2hf(x_n,y_n)$$

欧拉中点公式利用了$$y_n,y_{n-1}$$两个信息，被称为两步法。由

$$y(x_{n+1})=y(x_n)+hy'(x_n)+\frac{h^2}{2}y^{"}(x_n)+\frac{h^3}{6}y^{'''}(\xi_1)$$

$$y(x_{n-1})=y(x_n)-hy'(x_n)+\frac{h^2}{2}y^{"}(x_n)-\frac{h^3}{6}y^{'''}(\xi_2)$$

可得

$$y(x_{n+1})=y(x_{n-1})+2hy'(x_n)+\frac{h^3}{3}y^{'''}(\xi)$$

局部截断误差为$$O(h^3)$$，是一种二阶方法。

## 改进的欧拉方法
梯形公式为

$$y_{n+1}=y_n+\frac{h}{2}[f(x_n,y_n)+f(x_{n+1},y_{n+1})]$$

上式精度为二阶，但是一种隐式算法，计算量大。可先用欧拉法得到预测的$$y_{n+1}$$，然后迭代到上式。这就是改进的欧拉方法：

$$y_{n+1}=y_n+\frac{h}{2}[f(x_n,y_n)+f(x_{n+1},y_n+hf(x_n,y_n))]$$

# 龙格-库塔(Runge-Kutta,RK)方法
改进的欧拉方法可写成

$$y_{n+1}=y_n+\frac{1}{2}(k_1+k_2)$$

$$k_1=hf(x_n,y_n)$$

$$k_2=hf(x_n+h,y_n+k_1)$$

我们可以尝试增加计算$$f(x,y)$$的次数，以期提高截断误差的阶。所以，我们考虑如下形式的差分公式：

$$y_{n+1}=y_n+\sum_{i=1}^rc_ik_i$$

$$k_1=hf(x_n,y_n)$$

$$k_i=hf(x_n+\alpha_ih,y_n+\sum_{j=1}^{i-1}\beta_{ij}k_j)$$

其中$$c_i,\alpha_i,\beta_{ij}$$的选取需使得差分公式与泰勒展开式尽可能完全一致。下面以二阶龙格库塔方法进行说明：

$$y_{n+1}=y_n+c_1k_1+c_2k_2$$

$$k_1=hf(x_n,y_n)$$

$$k_2=hf(x_n+\alpha h,y_n+\beta k_1)$$

展开有

$$y_{n+1}=y_n+c_1hf(x_n,y_n)+c_2hf(x_n+\alpha h,y_n+\beta k_1)$$

$$=y_n+(c_1+c_2)f_nh+c_2(\alpha \frac{\partial f_n}{\partial x}+\beta\frac{\partial f_n}{\partial y}f_n)h^2+O(h^3)$$

与泰勒展开作比较

$$y(x_{n+1})=y(x_n)+y'(x_n)h+\frac{1}{2}y^"(x_n)h^2+O(h^3)$$

$$=y_n+f_nh+\frac{1}{2}(\frac{\partial f_n}{\partial x}+\frac{\partial f_n}{\partial y}f_n)+O(h^3)$$

应有$$c_1+c_2=1,c_2\alpha=\frac{1}{2},c_2\beta=\frac{1}{2}$$，若取$$\alpha=1$$，则是改进的欧拉公式。

高阶的R-K公式可作类似推导，最常用的是四阶R-K公式：

$$y_{n+1}=y_n+\frac{h}{6}(k_1+2k_2+2k_3+k_4)$$

$$k_1=f(x_n,y_n)$$

$$k_2=f(x_n+\frac{h}{2},y_n+\frac{h}{2}k_1)$$

$$k_3=f(x_n+\frac{h}{2},y_n+\frac{h}{2}k_2)$$

$$k_4=f(x_n+h,y_n+hk_3)$$
